{"version":3,"sources":["../../../../../../../../../../usr/local/lib/node_modules/browserify/node_modules/browser-pack/_prelude.js","dzsap-star-ratings.source.js"],"names":[],"mappings":"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","file":"bundle.js","sourcesContent":["(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c=\"function\"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error(\"Cannot find module '\"+i+\"'\");throw a.code=\"MODULE_NOT_FOUND\",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u=\"function\"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()","window.dzsap_part_starRatings_loaded = 'on';\n\n\nclass dzsapStarRatingsSource {\n  constructor(dzsapClass) {\n\n    this.$ratingCon = null;\n    this.inputStarSize = 20;\n    this.inputStarNumber = 5;\n    this.inputStarFormat = '<span style=\"width: 20px;\">&#9733;</span>';\n    this.dzsap = dzsapClass;\n\n    this.init();\n\n\n  }\n\n  viewUpdateStarSizes(){\n\n\n    const selfStarInstance = this;\n    const dzsapClass = this.dzsap;\n\n    const indexToPerc = Number(selfStarInstance.$ratingCon.eq(0).attr('data-initial-rating-index'));\n    let auxnr = Number(selfStarInstance.$ratingCon.eq(0).attr('data-initial-rating-index')) * 100;\n\n\n\n    if (dzsapClass.starrating_alreadyrated > -1 && dzsapClass.starrating_alreadyrated > 0) {\n      auxnr = dzsapClass.starrating_alreadyrated * 100 / selfStarInstance.inputStarNumber;\n    }\n\n    dzsapClass.cthis.find('.rating-prog').css({\n      'width': auxnr + '%'\n    })\n\n\n    dzsapClass.cthis.find('.star-rating-set-clip').css({\n      'opacity': 1\n    })\n    dzsapClass.cthis.find('.star-rating-set-clip').css({\n      'width': selfStarInstance.inputStarSize * selfStarInstance.inputStarNumber * indexToPerc\n    })\n  }\n\n  init() {\n\n    const selfStarInstance = this;\n    const dzsapClass = this.dzsap;\n    const $ = jQuery;\n    var starrating_index = 0;\n\n    this.$ratingCon = dzsapClass.cthis.find('.star-rating-con');\n\n    this.$ratingCon.get(0).selfStarInstance = selfStarInstance;\n\n\n    initVisual();\n\n\n    function initVisual() {\n\n      for (let i = 0; i < selfStarInstance.inputStarNumber; i++) {\n        selfStarInstance.$ratingCon.find('.star-rating-bg').append(selfStarInstance.inputStarFormat);\n        selfStarInstance.$ratingCon.find('.star-rating-prog').append(selfStarInstance.inputStarFormat);\n      }\n    }\n\n    function mouse_starrating(e) {\n      var $t = $(this);\n\n\n      if (dzsapClass.cthis.has($t).length === 0) {\n        return;\n      }\n\n      if (e.type === 'mouseleave') {\n        selfStarInstance.viewUpdateStarSizes()\n\n      }\n      if (e.type === 'mousemove') {\n        var mx = e.pageX - $t.offset().left;\n        var my = e.pageX - $t.offset().left;\n\n\n        starrating_index = Math.round(mx / ($t.outerWidth() / 5));\n\n\n        if (starrating_index > 4) {\n          starrating_index = 5;\n        } else {\n          starrating_index = Math.round(starrating_index);\n        }\n\n        if (starrating_index < 1) {\n          starrating_index = 1;\n        }\n\n\n        dzsapClass.cthis.find('.star-rating-prog-clip').css({\n          'width': (starrating_index / 5 * 100) + '%'\n        })\n\n        dzsapClass.starrating_alreadyrated = -1;\n\n\n        dzsapClass.cthis.find('.star-rating-set-clip').css({\n          'opacity': 0\n        })\n      }\n      if (e.type === 'click') {\n\n\n        dzsapClass.starrating_alreadyrated = -1;\n        if (dzsapClass.starrating_alreadyrated > -1 && dzsapClass.starrating_alreadyrated > 0) {\n          return;\n        }\n\n        ajax_submit_rating(dzsapClass, starrating_index);\n      }\n\n\n    }\n\n\n    $(document).on('mousemove', '.star-rating-con', mouse_starrating);\n    $(document).on('mouseleave', '.star-rating-con', mouse_starrating);\n    $(document).on('click', '.star-rating-con', mouse_starrating);\n  }\n}\n\n/**\n * only handles ajax call + result\n * @param dzsapInstance\n * @param starrating_index\n */\nfunction ajax_submit_rating(dzsapInstance, starrating_index) {\n\n\n  var $ = jQuery;\n\n\n  var data = {\n    action: 'dzsap_submit_rate',\n    postdata: starrating_index,\n    playerid: dzsapInstance.the_player_id\n  };\n\n\n  const onSuccess = (response) => {\n\n\n\n    let responseArr = {};\n\n    try {\n      responseArr = JSON.parse(response);\n    } catch (e) {\n    }\n\n    var percentSetRating = dzsapInstance.cthis.find('.star-rating-set-clip').outerWidth() / dzsapInstance.cthis.find('.star-rating-bg').outerWidth();\n    let nrOfRates = parseInt(dzsapInstance.cthis.find('.counter-rates .the-number').html(), 10);\n\n    nrOfRates++;\n\n    var percentFinalRating = ((nrOfRates - 1) * (percentSetRating * 5) + starrating_index) / (nrOfRates)\n\n\n    setTimeout(function () {\n\n      dzsapInstance.cthis.find('.star-rating-con').removeClass('just-rated');\n    }, 100);\n    dzsapInstance.cthis.find('.counter-rates .the-number').html(responseArr.rate_nr);\n\n    dzsapInstance.cthis.find('.star-rating-con').attr('data-initial-rating-index', Number(responseArr.rate_index) / 5);\n    dzsapInstance.cthis.find('.star-rating-con .rating-prog').css('width', (Number(responseArr.rate_index) / 5 * 100) + '%');\n\n    if (dzsapInstance.initOptions.parentgallery && $(dzsapInstance.initOptions.parentgallery).get(0) !== undefined && $(dzsapInstance.initOptions.parentgallery).get(0).api_player_rateSubmitted) {\n      $(dzsapInstance.initOptions.parentgallery).get(0).api_player_rateSubmitted();\n    }\n  }\n\n\n\n\n  if (dzsapInstance.starrating_alreadyrated > -1) {\n    return;\n  }\n\n  dzsapInstance.cthis.find('.star-rating-con').addClass('just-rated');\n  let totalWidth = parseInt(dzsapInstance.cthis.find('.star-rating-bg').width(), 10);\n  if (dzsapInstance.urlToAjaxHandler) {\n    jQuery.ajax({\n      type: \"POST\",\n      url: dzsapInstance.urlToAjaxHandler,\n      data: data,\n      success: onSuccess,\n      error: function (arg) {\n\n\n        var widthStarRatingClip = dzsapInstance.selfClass.cthis.find('.star-rating-set-clip').outerWidth() / dzsapInstance.cthis.find('.star-rating-bg').outerWidth();\n        var nrrates = parseInt(dzsapInstance.cthis.find('.counter-rates .the-number').html(), 10);\n\n        nrrates++;\n\n        var aux2 = ((nrrates - 1) * (widthStarRatingClip * 5) + starrating_index) / (nrrates)\n\n\n        dzsapInstance.cthis.find('.star-rating-set-clip').width(aux2 * (totalWidth / 5));\n        dzsapInstance.cthis.find('.counter-rates .the-number').html(nrrates);\n\n        if (dzsapInstance.initOptions.parentgallery && $(dzsapInstance.initOptions.parentgallery).get(0) && $(dzsapInstance.initOptions.parentgallery).get(0).api_player_rateSubmitted) {\n          $(dzsapInstance.initOptions.parentgallery).get(0).api_player_rateSubmitted();\n        }\n\n      }\n    });\n  }\n}\n\n\nwindow.dzsap_init_starRatings_from_dzsap = function (dzsapClass) {\n  var dzsapStarRatingsSourceInstance = new dzsapStarRatingsSource(dzsapClass);\n}\n"]}